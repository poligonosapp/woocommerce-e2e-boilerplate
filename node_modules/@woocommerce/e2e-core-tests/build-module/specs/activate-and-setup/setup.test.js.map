{"version":3,"sources":["/Users/ronrennick/Sites/solaris/woocommerce/packages/js/e2e-core-tests/src/specs/activate-and-setup/setup.test.js"],"names":["HTTPClientFactory","require","it","describe","deprecated","merchant","permalinkSettingsPageSaveChanges","setCheckbox","settingsPageSaveChanges","verifyCheckboxIsSet","verifyValueOfInputField","getTestConfig","waitAndClick","runInitialStoreSettingsTest","beforeAll","login","alternative","openSettings","expect","page","toMatchElement","text","Promise","all","openPermalinkSettings","click","toFill","testConfig","admin","users","client","build","url","withBasicAuth","username","password","withIndexPermalinks","create","response","get","status","toBe","module","exports"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nconst { HTTPClientFactory } = require( '@woocommerce/api' );\nconst {\n\tit,\n\tdescribe,\n} = require( '@jest/globals' );\nimport deprecated from '@wordpress/deprecated';\n\n/**\n * Internal dependencies\n */\nconst {\n\tmerchant,\n\tpermalinkSettingsPageSaveChanges,\n\tsetCheckbox,\n\tsettingsPageSaveChanges,\n\tverifyCheckboxIsSet,\n\tverifyValueOfInputField\n} = require( '@woocommerce/e2e-utils' );\n\nconst {\n\tgetTestConfig,\n\twaitAndClick\n} = require( '@woocommerce/e2e-environment' );\n\nconst runInitialStoreSettingsTest = () => {\n\tdescribe('Store owner can finish initial store setup', () => {\n\t\tbeforeAll(async () => {\n\t\t\tawait merchant.login();\n\t\t});\n\n\t\tit('can enable tax rates and calculations', async () => {\n\t\t\tdeprecated( 'runInitialStoreSettingsTest', {\n\t\t\t\talternative: '@woocommerce/admin-e2e-tests `testAdminBasicSetup()`',\n\t\t\t});\n\t\t\t// Go to general settings page\n\t\t\tawait merchant.openSettings('general');\n\n\t\t\t// Make sure the general tab is active\n\t\t\tawait expect(page).toMatchElement('a.nav-tab-active', {text: 'General'});\n\n\t\t\t// Enable tax rates and calculations\n\t\t\tawait setCheckbox('#woocommerce_calc_taxes');\n\n\t\t\tawait settingsPageSaveChanges();\n\n\t\t\t// Verify that settings have been saved\n\t\t\tawait Promise.all([\n\t\t\t\texpect(page).toMatchElement('#message', {text: 'Your settings have been saved.'}),\n\t\t\t\tverifyCheckboxIsSet('#woocommerce_calc_taxes'),\n\t\t\t]);\n\t\t});\n\n\t\tit('can configure permalink settings', async () => {\n\t\t\t// Go to Permalink Settings page\n\t\t\tawait merchant.openPermalinkSettings();\n\n\t\t\t// Select \"Post name\" option in common settings section\n\t\t\tawait page.click('input[value=\"/%postname%/\"]', {text: ' Post name'});\n\n\t\t\t// Select \"Custom base\" in product permalinks section\n\t\t\tawait waitAndClick( page, '#woocommerce_custom_selection' );\n\n\t\t\t// Fill custom base slug to use\n\t\t\tawait expect(page).toFill('#woocommerce_permalink_structure', '/product/');\n\n\t\t\tawait permalinkSettingsPageSaveChanges();\n\n\t\t\t// Verify that settings have been saved\n\t\t\tawait Promise.all([\n\t\t\t\texpect(page).toMatchElement('#setting-error-settings_updated', {text: 'Permalink structure updated.'}),\n\t\t\t\tverifyValueOfInputField('#permalink_structure', '/%postname%/'),\n\t\t\t\tverifyValueOfInputField('#woocommerce_permalink_structure', '/product/'),\n\t\t\t]);\n\t\t});\n\n\t\tit( 'can use api with pretty permalinks', async () => {\n\t\t\tconst testConfig = getTestConfig();\n\t\t\tconst admin = testConfig.users.admin;\n\t\t\tconst client = HTTPClientFactory.build( testConfig.url )\n\t\t\t\t.withBasicAuth( admin.username, admin.password )\n\t\t\t\t.withIndexPermalinks()\n\t\t\t\t.create();\n\n\t\t\tconst response = await client.get( '/wc/v3/products' );\n\t\t\texpect( response.status ).toBe( 200 );\n\t\t});\n\t});\n};\n\nmodule.exports = runInitialStoreSettingsTest;\n"]}