{"version":3,"sources":["/Users/ronrennick/Sites/solaris/woocommerce/packages/js/e2e-core-tests/src/specs/merchant/wp-admin-coupon-new.test.js"],"names":["merchant","clickTab","AdminEdit","withRestApi","require","it","describe","beforeAll","runCreateCouponTest","login","openNewCoupon","expect","page","title","resolves","toMatch","toFill","Date","getTime","toString","toSelect","adminEdit","verifyPublish","couponId","getId","deleteCoupon","module","exports"],"mappings":"AAAA;AACA;AACA;AACA,MAAM;AACLA,EAAAA,QADK;AAELC,EAAAA,QAFK;AAGLC,EAAAA,SAHK;AAILC,EAAAA;AAJK,IAKFC,OAAO,CAAE,wBAAF,CALX;AAOA;AACA;AACA;;;AACA,MAAM;AACLC,EAAAA,EADK;AAELC,EAAAA,QAFK;AAGLC,EAAAA;AAHK,IAIFH,OAAO,CAAE,eAAF,CAJX;;AAMA,MAAMI,mBAAmB,GAAG,MAAM;AACjCF,EAAAA,QAAQ,CAAC,qBAAD,EAAwB,MAAM;AACrCC,IAAAA,SAAS,CAAC,YAAY;AACrB,YAAMP,QAAQ,CAACS,KAAT,EAAN;AACA,KAFQ,CAAT;AAIAJ,IAAAA,EAAE,CAAC,uBAAD,EAA0B,YAAY;AACvC;AACA,YAAML,QAAQ,CAACU,aAAT,EAAN,CAFuC,CAIvC;;AACA,YAAMC,MAAM,CAACC,IAAI,CAACC,KAAL,EAAD,CAAN,CAAqBC,QAArB,CAA8BC,OAA9B,CAAsC,gBAAtC,CAAN,CALuC,CAOvC;;AACA,YAAMJ,MAAM,CAACC,IAAD,CAAN,CAAaI,MAAb,CAAoB,QAApB,EAA8B,UAAU,IAAIC,IAAJ,GAAWC,OAAX,GAAqBC,QAArB,EAAxC,CAAN;AACA,YAAMR,MAAM,CAACC,IAAD,CAAN,CAAaI,MAAb,CAAoB,iCAApB,EAAuD,aAAvD,CAAN,CATuC,CAWvC;;AACA,YAAMf,QAAQ,CAAC,SAAD,CAAd;AACA,YAAMU,MAAM,CAACC,IAAD,CAAN,CAAaQ,QAAb,CAAsB,gBAAtB,EAAwC,qBAAxC,CAAN;AACA,YAAMT,MAAM,CAACC,IAAD,CAAN,CAAaI,MAAb,CAAoB,gBAApB,EAAsC,KAAtC,CAAN,CAduC,CAgBvC;;AACA,YAAMK,SAAS,GAAG,IAAInB,SAAJ,EAAlB;AACA,YAAMmB,SAAS,CAACC,aAAV,CACL,UADK,EAEL,SAFK,EAGL,iBAHK,CAAN,CAlBuC,CAuBvC;;AACA,YAAMC,QAAQ,GAAG,MAAMF,SAAS,CAACG,KAAV,EAAvB;;AACA,UAAKD,QAAL,EAAgB;AACf,cAAMpB,WAAW,CAACsB,YAAZ,CAA0BF,QAA1B,CAAN;AACA;AACD,KA5BC,CAAF;AA6BA,GAlCO,CAAR;AAmCA,CApCD;;AAsCAG,MAAM,CAACC,OAAP,GAAiBnB,mBAAjB","sourcesContent":["/**\n * Internal dependencies\n */\nconst {\n\tmerchant,\n\tclickTab,\n\tAdminEdit,\n\twithRestApi,\n} = require( '@woocommerce/e2e-utils' );\n\n/**\n * External dependencies\n */\nconst {\n\tit,\n\tdescribe,\n\tbeforeAll,\n} = require( '@jest/globals' );\n\nconst runCreateCouponTest = () => {\n\tdescribe('Add New Coupon Page', () => {\n\t\tbeforeAll(async () => {\n\t\t\tawait merchant.login();\n\t\t});\n\n\t\tit('can create new coupon', async () => {\n\t\t\t// Go to \"add coupon\" page\n\t\t\tawait merchant.openNewCoupon();\n\n\t\t\t// Make sure we're on the add coupon page\n\t\t\tawait expect(page.title()).resolves.toMatch('Add new coupon');\n\n\t\t\t// Fill in coupon code and description\n\t\t\tawait expect(page).toFill('#title', 'code-' + new Date().getTime().toString());\n\t\t\tawait expect(page).toFill('#woocommerce-coupon-description', 'test coupon');\n\n\t\t\t// Set general coupon data\n\t\t\tawait clickTab('General');\n\t\t\tawait expect(page).toSelect('#discount_type', 'Fixed cart discount');\n\t\t\tawait expect(page).toFill('#coupon_amount', '100');\n\n\t\t\t// Publish coupon, verify that it was published.\n\t\t\tconst adminEdit = new AdminEdit();\n\t\t\tawait adminEdit.verifyPublish(\n\t\t\t\t'#publish',\n\t\t\t\t'.notice',\n\t\t\t\t'Coupon updated.',\n\t\t\t);\n\t\t\t// Delete the coupon\n\t\t\tconst couponId = await adminEdit.getId();\n\t\t\tif ( couponId ) {\n\t\t\t\tawait withRestApi.deleteCoupon( couponId );\n\t\t\t}\n\t\t});\n\t});\n}\n\nmodule.exports = runCreateCouponTest;\n"]}