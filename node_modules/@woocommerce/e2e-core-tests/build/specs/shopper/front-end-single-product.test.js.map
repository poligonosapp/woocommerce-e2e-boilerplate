{"version":3,"sources":["/Users/ronrennick/Sites/solaris/woocommerce/packages/js/e2e-core-tests/src/specs/shopper/front-end-single-product.test.js"],"names":["shopper","createSimpleProduct","createVariableProduct","createGroupedProduct","uiUnblocked","require","it","describe","beforeAll","config","simpleProductName","get","simplePostIdValue","defaultVariableProduct","variableProductId","simpleProductPrice","has","simple1","name","regularPrice","simple2","groupedProduct","groupedProducts","groupedPostIdValue","runSingleProductPageTest","goToProduct","expect","page","toFill","addToCart","toMatchElement","text","goToCart","productIsInCart","removeFromCart","attr","attributes","options","selectElem","toLowerCase","value","toSelect","waitForSelector","quantityFields","$$","click","clickCount","type","Promise","all","reload","waitForNavigation","waitUntil","module","exports"],"mappings":"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","sourcesContent":["/**\n * Internal dependencies\n */\nconst {\n\tshopper,\n\tcreateSimpleProduct,\n\tcreateVariableProduct,\n\tcreateGroupedProduct,\n\tuiUnblocked,\n} = require( '@woocommerce/e2e-utils' );\n\n/**\n * External dependencies\n */\nconst { it, describe, beforeAll } = require( '@jest/globals' );\nconst config = require( 'config' );\n\n// Variables for simple product\nconst simpleProductName = config.get( 'products.simple.name' );\nlet simplePostIdValue;\n\n// Variables for variable product\nconst defaultVariableProduct = config.get( 'products.variable' );\nlet variableProductId;\n\n// Variables for grouped product\nconst simpleProductPrice = config.has('products.simple.price') ? config.get('products.simple.price') : '9.99';\nconst simple1 = {\n\tname: simpleProductName + ' 1',\n\tregularPrice: simpleProductPrice\n};\nconst simple2 = {\n\tname: simpleProductName + ' 2',\n\tregularPrice: simpleProductPrice\n};\nconst groupedProduct = {\n\tname: 'Grouped Product',\n\tgroupedProducts: [simple1, simple2]\n};\nlet groupedPostIdValue;\n\nconst runSingleProductPageTest = () => {\n\tdescribe('Single Product Page', () => {\n\t\tbeforeAll(async () => {\n\t\t\tsimplePostIdValue = await createSimpleProduct();\n\t\t});\n\n\t\tit('should be able to add simple products to the cart', async () => {\n\t\t\t// Add 5 simple products to cart\n\t\t\tawait shopper.goToProduct(simplePostIdValue);\n\t\t\tawait expect(page).toFill('div.quantity input.qty', '5');\n\t\t\tawait shopper.addToCart();\n\t\t\tawait expect(page).toMatchElement('.woocommerce-message', {text: 'have been added to your cart.'});\n\n\t\t\t// Verify cart contents\n\t\t\tawait shopper.goToCart();\n\t\t\tawait shopper.productIsInCart(simpleProductName, 5);\n\t\t});\n\n\t\tit('should be able to remove simple products from the cart', async () => {\n\t\t\t// Remove items from cart\n\t\t\tawait shopper.removeFromCart( simplePostIdValue );\n\t\t\tawait uiUnblocked();\n\t\t\tawait expect(page).toMatchElement('.cart-empty', {text: 'Your cart is currently empty.'});\n\t\t});\n\t});\n\n\tdescribe('Variable Product Page', () => {\n\t\tbeforeAll(async () => {\n\t\t\tvariableProductId = await createVariableProduct();\n\t\t});\n\n\t\tit('should be able to add variation products to the cart', async () => {\n\t\t\t// Add a product with one set of variations to cart\n\t\t\tawait shopper.goToProduct(variableProductId);\n\n\t\t\tfor (const attr of defaultVariableProduct.attributes) {\n\t\t\t\tconst { name, options } = attr;\n\t\t\t\tconst selectElem = `#${name.toLowerCase()}`;\n\t\t\t\tconst value = options[0];\n\n\t\t\t\tawait expect(page).toSelect(selectElem, value);\n\t\t\t}\n\n\t\t\tawait shopper.addToCart();\n\t\t\tawait expect(page).toMatchElement('.woocommerce-message', {text: 'has been added to your cart.'});\n\n\t\t\t// Verify cart contents\n\t\t\tawait shopper.goToCart();\n\t\t\tawait shopper.productIsInCart(defaultVariableProduct.name);\n\t\t});\n\n\t\tit('should be able to remove variation products from the cart', async () => {\n\t\t\t// Remove items from cart\n\t\t\tawait shopper.removeFromCart( variableProductId );\n\t\t\tawait uiUnblocked();\n\t\t\tawait expect(page).toMatchElement('.cart-empty', {text: 'Your cart is currently empty.'});\n\t\t});\n\t});\n\n\tdescribe('Grouped Product Page', () => {\n\t\tbeforeAll(async () => {\n\t\t\tgroupedPostIdValue = await createGroupedProduct(groupedProduct);\n\t\t});\n\n\t\tit('should be able to add grouped products to the cart', async () => {\n\t\t\t// Add a grouped product to cart\n\t\t\tawait shopper.goToProduct(groupedPostIdValue);\n\t\t\tawait page.waitForSelector('form.grouped_form');\n\t\t\tawait shopper.addToCart();\n\t\t\tawait expect(page).toMatchElement('.woocommerce-error',\n\t\t\t {text: 'Please choose the quantity of items you wish to add to your cart…'});\n\t\t\tconst quantityFields = await page.$$('div.quantity input.qty');\n\t\t\tawait quantityFields[0].click({clickCount: 3});\n\t\t\tawait quantityFields[0].type('5');\n\t\t\tawait quantityFields[1].click({clickCount: 3});\n\t\t\tawait quantityFields[1].type('5');\n\t\t\tawait shopper.addToCart();\n\t\t\tawait expect(page).toMatchElement('.woocommerce-message',\n\t\t\t{text: '“'+simpleProductName+' 1” and “'+simpleProductName+' 2” have been added to your cart.'});\n\n\t\t\t// Verify cart contents\n\t\t\tawait shopper.goToCart();\n\t\t\tawait shopper.productIsInCart(simpleProductName+' 1');\n\t\t\tawait shopper.productIsInCart(simpleProductName+' 2');\n\t\t});\n\n\t\tit('should be able to remove grouped products from the cart', async () => {\n\t\t\t// Remove items from cart\n\t\t\tawait shopper.removeFromCart( simpleProductName+' 1' );\n\t\t\tawait uiUnblocked();\n\t\t\tawait expect(page).toMatchElement('.woocommerce-message', {text: '“'+simpleProductName+' 1” removed.'});\n\t\t\tawait Promise.all( [\n\t\t\t\t// Reload page and perform item removal, since removeFromCart won't remove it when placed in a row\n\t\t\t\tpage.reload(),\n\t\t\t\tpage.waitForNavigation( { waitUntil: 'networkidle0' } ),\n\t\t\t] );\n\t\t\tawait shopper.removeFromCart(simpleProductName+' 2');\n\t\t\tawait uiUnblocked();\n\t\t\tawait expect(page).toMatchElement('.woocommerce-message', {text: '“'+simpleProductName+' 2” removed.'});\n\t\t\tawait expect(page).toMatchElement('.cart-empty', {text: 'Your cart is currently empty.'});\n\t\t});\n\t});\n};\n\nmodule.exports = runSingleProductPageTest;\n"]}