{"version":3,"sources":["/Users/ronrennick/Sites/solaris/woocommerce/packages/js/e2e-core-tests/src/specs/shopper/front-end-variable-product-updates.test.js"],"names":["shopper","createVariableProduct","require","config","variablePostIdValue","cartDialogMessage","attributes","get","runVariableProductUpdateTest","describe","beforeAll","it","goToProduct","a","name","options","attrHTMLId","toLowerCase","expect","page","toSelect","toMatchElement","text","toClick","couponDialog","toDisplayDialog","message","toMatch","module","exports"],"mappings":"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","sourcesContent":["/* eslint-disable jest/no-export, jest/no-disabled-tests */\n/**\n * Internal dependencies\n */\nconst {\n\tshopper,\n\tcreateVariableProduct,\n} = require( '@woocommerce/e2e-utils' );\nconst config = require('config');\n\nlet variablePostIdValue;\n\nconst cartDialogMessage = 'Please select some product options before adding this product to your cart.';\nconst attributes = config.get( 'products.variable.attributes' )\n\nconst runVariableProductUpdateTest = () => {\n\tdescribe('Shopper > Update variable product',() => {\n\t\tbeforeAll(async () => {\n\t\t\tvariablePostIdValue = await createVariableProduct();\n\t\t});\n\n\t\tit('shopper can change variable attributes to the same value', async () => {\n\t\t\tawait shopper.goToProduct(variablePostIdValue);\n\n\t\t\tfor (const a of attributes) {\n\t\t\t\tconst { name, options } = a;\n\t\t\t\tconst attrHTMLId = `#${name.toLowerCase()}`;\n\n\t\t\t\tawait expect(page).toSelect(attrHTMLId, options[0]);\n\t\t\t}\n\n\t\t\tawait expect(page).toMatchElement('.woocommerce-variation-price', {\n\t\t\t\ttext: '9.99'\n\t\t\t});\n\t\t});\n\n\t\tit('shopper can change attributes to combination with dimensions and weight', async () => {\n\t\t\tawait shopper.goToProduct(variablePostIdValue);\n\t\t\tawait expect(page).toSelect(\n\t\t\t\t`#${attributes[0].name.toLowerCase()}`,\n\t\t\t\tattributes[0].options[0]\n\t\t\t);\n\t\t\tawait expect(page).toSelect(\n\t\t\t\t`#${attributes[1].name.toLowerCase()}`,\n\t\t\t\tattributes[1].options[1]\n\t\t\t);\n\t\t\tawait expect(page).toSelect(\n\t\t\t\t`#${attributes[2].name.toLowerCase()}`,\n\t\t\t\tattributes[2].options[0]\n\t\t\t);\n\n\t\t\tawait expect(page).toMatchElement('.woocommerce-variation-price', { text: '20.00' });\n\t\t\tawait expect(page).toMatchElement('.woocommerce-variation-availability', { text: 'Out of stock' });\n\t\t\tawait expect(page).toMatchElement('.woocommerce-product-attributes-item--weight', { text: '200 kg' });\n\t\t\tawait expect(page).toMatchElement('.woocommerce-product-attributes-item--dimensions', { text: '10 × 20 × 15 cm' });\n\n\t\t});\n\n\t\tit('shopper can change variable product attributes to variation with a different price', async () => {\n\t\t\tawait shopper.goToProduct(variablePostIdValue);\n\t\t\tawait expect(page).toSelect(\n\t\t\t\t`#${attributes[0].name.toLowerCase()}`,\n\t\t\t\tattributes[0].options[0]\n\t\t\t);\n\t\t\tawait expect(page).toSelect(\n\t\t\t\t`#${attributes[1].name.toLowerCase()}`,\n\t\t\t\tattributes[1].options[0]\n\t\t\t);\n\t\t\tawait expect(page).toSelect(\n\t\t\t\t`#${attributes[2].name.toLowerCase()}`,\n\t\t\t\tattributes[2].options[1]\n\t\t\t);\n\n\t\t\tawait expect(page).toMatchElement('.woocommerce-variation-price', { text: '11.99' });\n\t\t});\n\n\t\tit('shopper can reset variations', async () => {\n\t\t\tawait shopper.goToProduct(variablePostIdValue);\n\t\t\tawait expect(page).toSelect(\n\t\t\t\t`#${attributes[0].name.toLowerCase()}`,\n\t\t\t\tattributes[0].options[0]\n\t\t\t);\n\t\t\tawait expect(page).toSelect(\n\t\t\t\t`#${attributes[1].name.toLowerCase()}`,\n\t\t\t\tattributes[1].options[1]\n\t\t\t);\n\t\t\tawait expect(page).toSelect(\n\t\t\t\t`#${attributes[2].name.toLowerCase()}`,\n\t\t\t\tattributes[2].options[0]\n\t\t\t);\n\n\t\t\tawait expect(page).toClick('.reset_variations');\n\n\t\t\t// Verify the reset by attempting to add the product to the cart\n\t\t\tconst couponDialog = await expect(page).toDisplayDialog(async () => {\n\t\t\t\t\tawait expect(page).toClick('.single_add_to_cart_button');\n\t\t\t\t});\n\n\t\t\texpect(couponDialog.message()).toMatch(cartDialogMessage);\n\t\t});\n\n\t});\n\t\n};\n\nmodule.exports = runVariableProductUpdateTest;\n"]}