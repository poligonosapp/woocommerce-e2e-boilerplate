{"version":3,"sources":["/Users/ronrennick/Sites/solaris/woocommerce/packages/js/e2e-core-tests/src/specs/shopper/front-end-cart-redirection.test.js"],"names":["shopper","merchant","createSimpleProduct","setCheckbox","unsetCheckbox","settingsPageSaveChanges","utils","require","it","describe","beforeAll","afterAll","config","simpleProductName","get","runCartRedirectionTest","simplePostIdValue","login","openSettings","logout","goToShop","addToCartXPath","addToCartButton","page","$x","click","waitForTimeout","productIsInCart","removeFromCart","goToProduct","addToCart","module","exports"],"mappings":";;AAAA;AACA;AACA;AACC,MAAM;AACNA,EAAAA,OADM;AAENC,EAAAA,QAFM;AAGNC,EAAAA,mBAHM;AAINC,EAAAA,WAJM;AAKNC,EAAAA,aALM;AAMNC,EAAAA,uBANM;AAONC,EAAAA;AAPM,IAQHC,OAAO,CAAE,wBAAF,CARV;AAUD;AACA;AACA;;;AACC,MAAM;AACNC,EAAAA,EADM;AAENC,EAAAA,QAFM;AAGNC,EAAAA,SAHM;AAINC,EAAAA;AAJM,IAKHJ,OAAO,CAAE,eAAF,CALV;;AAOD,MAAMK,MAAM,GAAGL,OAAO,CAAE,QAAF,CAAtB;;AACA,MAAMM,iBAAiB,GAAGD,MAAM,CAACE,GAAP,CAAY,sBAAZ,CAA1B;;AAEA,MAAMC,sBAAsB,GAAG,MAAM;AACpCN,EAAAA,QAAQ,CAAC,mCAAD,EAAsC,MAAM;AACnD,QAAIO,iBAAJ;AACAN,IAAAA,SAAS,CAAC,YAAY;AACrBM,MAAAA,iBAAiB,GAAG,MAAMd,mBAAmB,EAA7C,CADqB,CAGrB;;AACA,YAAMD,QAAQ,CAACgB,KAAT,EAAN;AACA,YAAMhB,QAAQ,CAACiB,YAAT,CAAsB,UAAtB,CAAN;AACA,YAAMf,WAAW,CAAC,sCAAD,CAAjB;AACA,YAAME,uBAAuB,EAA7B;AAEA,YAAMJ,QAAQ,CAACkB,MAAT,EAAN;AACA,KAVQ,CAAT;AAYAX,IAAAA,EAAE,CAAC,0CAAD,EAA6C,YAAY;AAC1D,YAAMR,OAAO,CAACoB,QAAR,EAAN,CAD0D,CAG1D;;AACA,YAAMC,cAAc,GAAI,oEAAoER,iBAAmB,MAAxF,GACvB,qFADA;AAEA,YAAM,CAAES,eAAF,IAAsB,MAAMC,IAAI,CAACC,EAAL,CAASH,cAAc,GAAG,GAA1B,CAAlC;AACAC,MAAAA,eAAe,CAACG,KAAhB;AACA,YAAMnB,KAAK,CAACoB,cAAN,CAAsB,IAAtB,CAAN,CAR0D,CAQtB;;AAEpC,YAAM1B,OAAO,CAAC2B,eAAR,CAAwBd,iBAAxB,CAAN;AACA,YAAMb,OAAO,CAAC4B,cAAR,CAAwBZ,iBAAxB,CAAN;AACA,KAZC,CAAF;AAcAR,IAAAA,EAAE,CAAC,4CAAD,EAA+C,YAAY;AAC5D,YAAMR,OAAO,CAAC6B,WAAR,CAAoBb,iBAApB,CAAN,CAD4D,CAG5D;;AACA,YAAMhB,OAAO,CAAC8B,SAAR,EAAN;AACA,YAAMxB,KAAK,CAACoB,cAAN,CAAsB,IAAtB,CAAN,CAL4D,CAKxB;;AAEpC,YAAM1B,OAAO,CAAC2B,eAAR,CAAwBd,iBAAxB,CAAN;AACA,YAAMb,OAAO,CAAC4B,cAAR,CAAwBZ,iBAAxB,CAAN;AACA,KATC,CAAF;AAWAL,IAAAA,QAAQ,CAAC,YAAY;AACpB,YAAMV,QAAQ,CAACgB,KAAT,EAAN;AACA,YAAMhB,QAAQ,CAACiB,YAAT,CAAsB,UAAtB,CAAN;AACA,YAAMd,aAAa,CAAC,sCAAD,CAAnB;AACA,YAAMC,uBAAuB,EAA7B;AACA,KALO,CAAR;AAMA,GA7CO,CAAR;AA8CA,CA/CD;;AAiDA0B,MAAM,CAACC,OAAP,GAAiBjB,sBAAjB","sourcesContent":["/**\n * Internal dependencies\n */\n const {\n\tshopper,\n\tmerchant,\n\tcreateSimpleProduct,\n\tsetCheckbox,\n\tunsetCheckbox,\n\tsettingsPageSaveChanges,\n\tutils,\n} = require( '@woocommerce/e2e-utils' );\n\n/**\n * External dependencies\n */\n const {\n\tit,\n\tdescribe,\n\tbeforeAll,\n\tafterAll,\n} = require( '@jest/globals' );\n\nconst config = require( 'config' );\nconst simpleProductName = config.get( 'products.simple.name' );\n\nconst runCartRedirectionTest = () => {\n\tdescribe('Cart > Redirect to cart from shop', () => {\n\t\tlet simplePostIdValue;\n\t\tbeforeAll(async () => {\n\t\t\tsimplePostIdValue = await createSimpleProduct();\n\n\t\t\t// Set checkbox in settings to enable cart redirection\n\t\t\tawait merchant.login();\n\t\t\tawait merchant.openSettings('products');\n\t\t\tawait setCheckbox('#woocommerce_cart_redirect_after_add');\n\t\t\tawait settingsPageSaveChanges();\n\n\t\t\tawait merchant.logout();\n\t\t});\n\n\t\tit('can redirect user to cart from shop page', async () => {\n\t\t\tawait shopper.goToShop();\n\n\t\t\t// Add to cart from shop page\n\t\t\tconst addToCartXPath = `//li[contains(@class, \"type-product\") and a/h2[contains(text(), \"${ simpleProductName }\")]]` +\n\t\t\t'//a[contains(@class, \"add_to_cart_button\") and contains(@class, \"ajax_add_to_cart\")';\n\t\t\tconst [ addToCartButton ] = await page.$x( addToCartXPath + ']' );\n\t\t\taddToCartButton.click();\n\t\t\tawait utils.waitForTimeout( 1000 ); // to avoid flakiness\n\n\t\t\tawait shopper.productIsInCart(simpleProductName);\n\t\t\tawait shopper.removeFromCart( simplePostIdValue );\n\t\t});\n\n\t\tit('can redirect user to cart from detail page', async () => {\n\t\t\tawait shopper.goToProduct(simplePostIdValue);\n\n\t\t\t// Add to cart from detail page\n\t\t\tawait shopper.addToCart();\n\t\t\tawait utils.waitForTimeout( 1000 ); // to avoid flakiness\n\n\t\t\tawait shopper.productIsInCart(simpleProductName);\n\t\t\tawait shopper.removeFromCart( simplePostIdValue );\n\t\t});\n\n\t\tafterAll(async () => {\n\t\t\tawait merchant.login();\n\t\t\tawait merchant.openSettings('products');\n\t\t\tawait unsetCheckbox('#woocommerce_cart_redirect_after_add');\n\t\t\tawait settingsPageSaveChanges();\n\t\t});\n\t});\n};\n\nmodule.exports = runCartRedirectionTest;\n"]}