{"version":3,"sources":["/Users/ronrennick/Sites/solaris/woocommerce/packages/js/e2e-core-tests/src/specs/shopper/front-end-product-browse-search-sort.test.js"],"names":["shopper","createSimpleProductWithCategory","utils","getEnvironmentContext","require","it","beforeAll","config","simpleProductName","get","singleProductPrice","has","singleProductPrice2","singleProductPrice3","clothing","audio","hardware","productTitle","getWordPressVersion","context","wpVersion","runProductBrowseSearchSortTest","describeIf","goToShop","searchForProduct","page","waitForNavigation","waitUntil","Promise","all","click","text","waitForSelector","expect","toMatchElement","toClick","select","module","exports"],"mappings":"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","sourcesContent":["/**\n * Internal dependencies\n */\nconst {\n\tshopper,\n\tcreateSimpleProductWithCategory,\n\tutils,\n\tgetEnvironmentContext,\n} = require( '@woocommerce/e2e-utils' );\n\n/**\n * External dependencies\n */\nconst { it, beforeAll } = require( '@jest/globals' );\n\nconst config = require( 'config' );\nconst simpleProductName = config.get( 'products.simple.name' );\nconst singleProductPrice = config.has('products.simple.price') ? config.get('products.simple.price') : '9.99';\nconst singleProductPrice2 = config.has('products.simple.price') ? '1' + singleProductPrice : '19.99';\nconst singleProductPrice3 = config.has('products.simple.price') ? '2' + singleProductPrice : '29.99';\nconst clothing = 'Clothing';\nconst audio = 'Audio';\nconst hardware = 'Hardware';\nconst productTitle = 'li.first > a > h2.woocommerce-loop-product__title';\n\nconst getWordPressVersion = async () => {\n\tconst context = await getEnvironmentContext();\n\treturn context.wpVersion;\n}\n\nconst runProductBrowseSearchSortTest = () => {\n\tutils.describeIf( getWordPressVersion() >= 5.8 )( 'Search, browse by categories and sort items in the shop', () => {\n\t\tbeforeAll(async () => {\n\t\t\t// Create 1st product with Clothing category\n\t\t\tawait createSimpleProductWithCategory(simpleProductName + ' 1', singleProductPrice, clothing);\n\t\t\t// Create 2nd product with Audio category\n\t\t\tawait createSimpleProductWithCategory(simpleProductName + ' 2', singleProductPrice2, audio);\n\t\t\t// Create 3rd product with Hardware category\n\t\t\tawait createSimpleProductWithCategory(simpleProductName + ' 3', singleProductPrice3, hardware);\n\t\t});\n\n\t\tit('should let user search the store', async () => {\n\t\t\tawait shopper.goToShop();\n\t\t\tawait shopper.searchForProduct(simpleProductName + ' 1');\n\t\t\tpage.waitForNavigation({waitUntil: 'networkidle0'});\n\t\t});\n\n\t\tit('should let user browse products by categories', async () => {\n\t\t\t// Browse through Clothing category link\n\t\t\tawait Promise.all([\n\t\t\t\tpage.click('span.posted_in > a', {text: clothing}),\n\t\t\t\tpage.waitForNavigation({waitUntil: 'networkidle0'}),\n\t\t\t]);\n\n\t\t\t// Verify Clothing category page\n\t\t\tawait page.waitForSelector(productTitle);\n\t\t\tawait expect(page).toMatchElement(productTitle, {text: simpleProductName + ' 1'});\n\t\t\tawait expect(page).toClick(productTitle, {text: simpleProductName + ' 1'});\n\t\t\tpage.waitForNavigation({waitUntil: 'networkidle0'});\n\t\t\tawait page.waitForSelector('h1.entry-title');\n\t\t\tawait expect(page).toMatchElement('h1.entry-title', simpleProductName + ' 1');\n\t\t});\n\n\t\tit('should let user sort the products in the shop', async () => {\n\t\t\tawait shopper.goToShop();\n\n\t\t\t// Sort by price high to low\n\t\t\tawait page.select('.orderby', 'price-desc');\n\t\t\t// Verify the first product in sort order\n\t\t\tawait expect(page).toMatchElement(productTitle, {text: simpleProductName + ' 3'});\n\n\t\t\t// Sort by price low to high\n\t\t\tawait page.select('.orderby', 'price');\n\t\t\t// Verify the first product in sort order\n\t\t\tawait expect(page).toMatchElement(productTitle, {text: simpleProductName + ' 1'});\n\n\t\t\t// Sort by date of creation, latest to oldest\n\t\t\tawait page.select('.orderby', 'date');\n\t\t\t// Verify the first product in sort order\n\t\t\tawait expect(page).toMatchElement(productTitle, {text: simpleProductName + ' 3'});\n\t\t});\n\t});\n};\n\nmodule.exports = runProductBrowseSearchSortTest;\n"]}