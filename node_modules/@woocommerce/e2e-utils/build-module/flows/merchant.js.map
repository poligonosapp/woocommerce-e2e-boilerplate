{"version":3,"sources":["/Users/ronrennick/Sites/solaris/woocommerce/packages/js/e2e-utils/src/flows/merchant.js"],"names":["config","require","clearAndFillInput","setCheckbox","WP_ADMIN_ALL_ORDERS_VIEW","WP_ADMIN_ALL_PRODUCTS_VIEW","WP_ADMIN_DASHBOARD","WP_ADMIN_LOGIN","WP_ADMIN_NEW_COUPON","WP_ADMIN_NEW_ORDER","WP_ADMIN_NEW_PRODUCT","WP_ADMIN_PERMALINK_SETTINGS","WP_ADMIN_PLUGINS","WP_ADMIN_SETUP_WIZARD","WP_ADMIN_WC_HOME","WP_ADMIN_WC_SETTINGS","WP_ADMIN_WC_EXTENSIONS","WP_ADMIN_WC_HELPER","WP_ADMIN_NEW_SHIPPING_ZONE","WP_ADMIN_ANALYTICS_PAGES","WP_ADMIN_ALL_USERS_VIEW","WP_ADMIN_IMPORT_PRODUCTS","WP_ADMIN_PLUGIN_INSTALL","WP_ADMIN_WP_UPDATES","IS_RETEST_MODE","getSlug","waitForTimeout","baseUrl","get","WP_ADMIN_SINGLE_CPT_VIEW","postId","merchant","login","page","goto","waitUntil","expect","title","resolves","toMatch","type","Promise","all","click","waitForNavigation","dismissOnboardingWizard","logout","logoutLinks","$$eval","am","filter","e","href","map","openAllOrdersView","openAllProductsView","openDashboard","openNewCoupon","openNewOrder","openNewProduct","openPermalinkSettings","openPlugins","openSettings","tab","section","settingsUrl","openExtensions","openHelper","runSetupWizard","setupWizard","goToOrder","orderId","goToProduct","productId","updateOrderStatus","status","toSelect","toClick","waitForSelector","toMatchElement","text","verifyOrder","productName","productPrice","quantity","orderTotal","ensureCustomerRegistered","toString","openNewShipping","openEmailLog","openAnalyticsPage","pageName","openAllUsersView","openImportProducts","openWordPressUpdatesPage","installAllUpdates","updateWordPress","updatePlugins","updateThemes","$","timeout","uploadAndActivatePlugin","pluginFilePath","pluginName","pluginSlug","deactivatePlugin","uploader","uploadFile","evaluate","document","getElementById","disabled","activatePlugin","deletePlugin","waitForResponse","response","runDatabaseUpdate","checkDatabaseUpdateComplete","reload","thanksButtonSelector","waitForNav","skipButton","usageTrackingHeader","collapseAdminMenu","collapse","collapseButton","module","exports"],"mappings":"AAAA;AACA;AACA;AACA,MAAMA,MAAM,GAAGC,OAAO,CAAE,QAAF,CAAtB;AAEA;AACA;AACA;;;AACA,MAAM;AAAEC,EAAAA,iBAAF;AAAqBC,EAAAA;AAArB,IAAqCF,OAAO,CAAE,eAAF,CAAlD;;AACA,MAAM;AACLG,EAAAA,wBADK;AAELC,EAAAA,0BAFK;AAGLC,EAAAA,kBAHK;AAILC,EAAAA,cAJK;AAKLC,EAAAA,mBALK;AAMLC,EAAAA,kBANK;AAOLC,EAAAA,oBAPK;AAQLC,EAAAA,2BARK;AASLC,EAAAA,gBATK;AAULC,EAAAA,qBAVK;AAWLC,EAAAA,gBAXK;AAYLC,EAAAA,oBAZK;AAaLC,EAAAA,sBAbK;AAcLC,EAAAA,kBAdK;AAeLC,EAAAA,0BAfK;AAgBLC,EAAAA,wBAhBK;AAiBLC,EAAAA,uBAjBK;AAkBLC,EAAAA,wBAlBK;AAmBLC,EAAAA,uBAnBK;AAoBLC,EAAAA,mBApBK;AAqBLC,EAAAA;AArBK,IAsBFvB,OAAO,CAAE,aAAF,CAtBX;;AAwBA,MAAM;AAAEwB,EAAAA,OAAF;AAAWC,EAAAA;AAAX,IAA8BzB,OAAO,CAAC,SAAD,CAA3C;;AAEA,MAAM0B,OAAO,GAAG3B,MAAM,CAAC4B,GAAP,CAAY,KAAZ,CAAhB;;AACA,MAAMC,wBAAwB,GAAKC,MAAF,IAAcH,OAAO,GAAI,0BAA0BG,MAAQ,cAA5F;;AAEA,MAAMC,QAAQ,GAAG;AAChBC,EAAAA,KAAK,EAAE,YAAY;AAClB,UAAMC,IAAI,CAACC,IAAL,CAAW3B,cAAX,EAA2B;AAChC4B,MAAAA,SAAS,EAAE;AADqB,KAA3B,CAAN;AAIA,UAAMC,MAAM,CAAEH,IAAI,CAACI,KAAL,EAAF,CAAN,CAAuBC,QAAvB,CAAgCC,OAAhC,CAAyC,QAAzC,CAAN;AAEA,UAAMrC,iBAAiB,CAAE,aAAF,EAAiB,GAAjB,CAAvB;AAEA,UAAM+B,IAAI,CAACO,IAAL,CAAW,aAAX,EAA0BxC,MAAM,CAAC4B,GAAP,CAAY,sBAAZ,CAA1B,CAAN;AACA,UAAMK,IAAI,CAACO,IAAL,CAAW,YAAX,EAAyBxC,MAAM,CAAC4B,GAAP,CAAY,sBAAZ,CAAzB,CAAN;AAEA,UAAMa,OAAO,CAACC,GAAR,CAAa,CAClBT,IAAI,CAACU,KAAL,CAAY,oBAAZ,CADkB,EAElBV,IAAI,CAACW,iBAAL,CAAwB;AAAET,MAAAA,SAAS,EAAE;AAAb,KAAxB,CAFkB,EAGlBJ,QAAQ,CAACc,uBAAT,EAHkB,CAAb,CAAN;AAKA,GAlBe;AAoBhBC,EAAAA,MAAM,EAAE,YAAY;AACnB;AACA,UAAMC,WAAW,GAAG,MAAMd,IAAI,CAACe,MAAL,CACzB,wBADyB,EAEvBC,EAAF,IAAUA,EAAE,CAACC,MAAH,CAAaC,CAAF,IAASA,CAAC,CAACC,IAAtB,EAA6BC,GAA7B,CAAoCF,CAAF,IAASA,CAAC,CAACC,IAA7C,CAFe,CAA1B;;AAKA,QAAKL,WAAW,IAAIA,WAAW,CAAC,CAAD,CAA/B,EAAqC;AACpC,YAAMd,IAAI,CAACC,IAAL,CAAUa,WAAW,CAAC,CAAD,CAArB,EAA0B;AAC/BZ,QAAAA,SAAS,EAAE;AADoB,OAA1B,CAAN;AAGA;AACD,GAhCe;AAkChBmB,EAAAA,iBAAiB,EAAE,YAAY;AAC9B,UAAMrB,IAAI,CAACC,IAAL,CAAW9B,wBAAX,EAAqC;AAC1C+B,MAAAA,SAAS,EAAE;AAD+B,KAArC,CAAN;AAGA,GAtCe;AAwChBoB,EAAAA,mBAAmB,EAAE,YAAY;AAChC,UAAMtB,IAAI,CAACC,IAAL,CAAW7B,0BAAX,EAAuC;AAC5C8B,MAAAA,SAAS,EAAE;AADiC,KAAvC,CAAN;AAGA,GA5Ce;AA8ChBqB,EAAAA,aAAa,EAAE,YAAY;AAC1B,UAAMvB,IAAI,CAACC,IAAL,CAAW5B,kBAAX,EAA+B;AACpC6B,MAAAA,SAAS,EAAE;AADyB,KAA/B,CAAN;AAGA,GAlDe;AAoDhBsB,EAAAA,aAAa,EAAE,YAAY;AAC1B,UAAMxB,IAAI,CAACC,IAAL,CAAW1B,mBAAX,EAAgC;AACrC2B,MAAAA,SAAS,EAAE;AAD0B,KAAhC,CAAN;AAGA,GAxDe;AA0DhBuB,EAAAA,YAAY,EAAE,YAAY;AACzB,UAAMzB,IAAI,CAACC,IAAL,CAAWzB,kBAAX,EAA+B;AACpC0B,MAAAA,SAAS,EAAE;AADyB,KAA/B,CAAN;AAGA,GA9De;AAgEhBwB,EAAAA,cAAc,EAAE,YAAY;AAC3B,UAAM1B,IAAI,CAACC,IAAL,CAAWxB,oBAAX,EAAiC;AACtCyB,MAAAA,SAAS,EAAE;AAD2B,KAAjC,CAAN;AAGA,GApEe;AAsEhByB,EAAAA,qBAAqB,EAAE,YAAY;AAClC,UAAM3B,IAAI,CAACC,IAAL,CAAWvB,2BAAX,EAAwC;AAC7CwB,MAAAA,SAAS,EAAE;AADkC,KAAxC,CAAN;AAGA,GA1Ee;AA4EhB0B,EAAAA,WAAW,EAAE,YAAY;AACxB,UAAM5B,IAAI,CAACC,IAAL,CAAWtB,gBAAX,EAA6B;AAClCuB,MAAAA,SAAS,EAAE;AADuB,KAA7B,CAAN;AAGA,GAhFe;AAkFhB2B,EAAAA,YAAY,EAAE,gBAAQC,GAAR,EAAiC;AAAA,QAApBC,OAAoB,uEAAV,IAAU;AAC9C,QAAIC,WAAW,GAAGlD,oBAAoB,GAAGgD,GAAzC;;AAEA,QAAKC,OAAL,EAAe;AACdC,MAAAA,WAAW,IAAK,YAAYD,OAAS,EAArC;AACA;;AAED,UAAM/B,IAAI,CAACC,IAAL,CAAW+B,WAAX,EAAwB;AAC7B9B,MAAAA,SAAS,EAAE;AADkB,KAAxB,CAAN;AAGA,GA5Fe;AA8FhB+B,EAAAA,cAAc,EAAE,YAAY;AAC3B,UAAMjC,IAAI,CAACC,IAAL,CAAWlB,sBAAX,EAAmC;AACxCmB,MAAAA,SAAS,EAAE;AAD6B,KAAnC,CAAN;AAGA,GAlGe;AAoGhBgC,EAAAA,UAAU,EAAE,YAAY;AACvB,UAAMlC,IAAI,CAACC,IAAL,CAAWjB,kBAAX,EAA+B;AACpCkB,MAAAA,SAAS,EAAE;AADyB,KAA/B,CAAN;AAGA,GAxGe;AA0GhBiC,EAAAA,cAAc,EAAE,YAAY;AAC1B,UAAMC,WAAW,GAAG7C,cAAc,GAAGX,qBAAH,GAA2BC,gBAA7D;AACA,UAAMmB,IAAI,CAACC,IAAL,CAAWmC,WAAX,EAAwB;AAC9BlC,MAAAA,SAAS,EAAE;AADmB,KAAxB,CAAN;AAGD,GA/Ge;AAkHhBmC,EAAAA,SAAS,EAAE,MAAQC,OAAR,IAAqB;AAC/B,UAAMtC,IAAI,CAACC,IAAL,CAAWL,wBAAwB,CAAE0C,OAAF,CAAnC,EAAgD;AACrDpC,MAAAA,SAAS,EAAE;AAD0C,KAAhD,CAAN;AAGA,GAtHe;AAwHhBqC,EAAAA,WAAW,EAAE,MAAQC,SAAR,IAAuB;AACnC,UAAMxC,IAAI,CAACC,IAAL,CAAWL,wBAAwB,CAAE4C,SAAF,CAAnC,EAAkD;AACvDtC,MAAAA,SAAS,EAAE;AAD4C,KAAlD,CAAN;AAGA,GA5He;AA8HhBuC,EAAAA,iBAAiB,EAAE,OAAQH,OAAR,EAAiBI,MAAjB,KAA6B;AAC/C,UAAM1C,IAAI,CAACC,IAAL,CAAWL,wBAAwB,CAAE0C,OAAF,CAAnC,EAAgD;AACrDpC,MAAAA,SAAS,EAAE;AAD0C,KAAhD,CAAN;AAGA,UAAMC,MAAM,CAAEH,IAAF,CAAN,CAAe2C,QAAf,CAAyB,eAAzB,EAA0CD,MAA1C,CAAN;AACA,UAAMjD,cAAc,CAAE,IAAF,CAApB;AACA,UAAMU,MAAM,CAAEH,IAAF,CAAN,CAAe4C,OAAf,CAAwB,mBAAxB,CAAN;AACA,UAAM5C,IAAI,CAAC6C,eAAL,CAAsB,UAAtB,CAAN;AACA,UAAM1C,MAAM,CAAEH,IAAF,CAAN,CAAe8C,cAAf,CAA+B,UAA/B,EAA2C;AAAEC,MAAAA,IAAI,EAAE;AAAR,KAA3C,CAAN;AACA,GAvIe;AAyIhBC,EAAAA,WAAW,EAAE,gBAAOV,OAAP,EAAgBW,WAAhB,EAA6BC,YAA7B,EAA2CC,QAA3C,EAAqDC,UAArD,EAAsG;AAAA,QAArCC,wBAAqC,uEAAV,KAAU;AAClH,UAAMvD,QAAQ,CAACuC,SAAT,CAAmBC,OAAnB,CAAN,CADkH,CAGlH;AACA;;AACA,UAAMnC,MAAM,CAACH,IAAD,CAAN,CAAa8C,cAAb,CAA4B,kCAA5B,EAAgE;AAACC,MAAAA,IAAI,EAAE,YAAYT,OAAZ,GAAsB;AAA7B,KAAhE,CAAN,CALkH,CAOlH;;AACA,UAAMnC,MAAM,CAACH,IAAD,CAAN,CAAa8C,cAAb,CAA4B,qBAA5B,EAAmD;AAACC,MAAAA,IAAI,EAAEE;AAAP,KAAnD,CAAN,CARkH,CAUlH;;AACA,UAAM9C,MAAM,CAACH,IAAD,CAAN,CAAa8C,cAAb,CAA4B,kCAA5B,EAAgE;AAACC,MAAAA,IAAI,EAAEG;AAAP,KAAhE,CAAN,CAXkH,CAalH;;AACA,UAAM/C,MAAM,CAACH,IAAD,CAAN,CAAa8C,cAAb,CAA4B,WAA5B,EAAyC;AAACC,MAAAA,IAAI,EAAEI,QAAQ,CAACG,QAAT;AAAP,KAAzC,CAAN,CAdkH,CAgBlH;;AACA,UAAMnD,MAAM,CAACH,IAAD,CAAN,CAAa8C,cAAb,CAA4B,YAA5B,EAA0C;AAACC,MAAAA,IAAI,EAAEK;AAAP,KAA1C,CAAN;;AAEA,QAAKC,wBAAL,EAAgC;AAC/B;AACA,YAAMlD,MAAM,CAAEH,IAAF,CAAN,CAAe8C,cAAf,CAA+B,+CAA/B,EAAgF;AAAEC,QAAAA,IAAI,EAAE;AAAR,OAAhF,CAAN;AACA;AACD,GAhKe;AAkKhBQ,EAAAA,eAAe,EAAE,YAAY;AAC5B,UAAMvD,IAAI,CAACC,IAAL,CAAWhB,0BAAX,EAAuC;AAC5CiB,MAAAA,SAAS,EAAE;AADiC,KAAvC,CAAN;AAGA,GAtKe;AAwKhBsD,EAAAA,YAAY,EAAE,YAAY;AACzB,UAAMxD,IAAI,CAACC,IAAL,CAAY,GAAEP,OAAQ,yCAAtB,EAAgE;AACrEQ,MAAAA,SAAS,EAAE;AAD0D,KAAhE,CAAN;AAGA,GA5Ke;AA8KhBuD,EAAAA,iBAAiB,EAAE,MAAQC,QAAR,IAAsB;AACxC,UAAM1D,IAAI,CAACC,IAAL,CAAWf,wBAAwB,GAAGwE,QAAtC,EAAgD;AACrDxD,MAAAA,SAAS,EAAE;AAD0C,KAAhD,CAAN;AAGA,GAlLe;AAoLhByD,EAAAA,gBAAgB,EAAE,YAAY;AAC7B,UAAM3D,IAAI,CAACC,IAAL,CAAWd,uBAAX,EAAoC;AACzCe,MAAAA,SAAS,EAAE;AAD8B,KAApC,CAAN;AAGA,GAxLe;AA0Ld0D,EAAAA,kBAAkB,EAAE,YAAY;AACjC,UAAM5D,IAAI,CAACC,IAAL,CAAWb,wBAAX,EAAsC;AAC3Cc,MAAAA,SAAS,EAAE;AADgC,KAAtC,CAAN;AAGA,GA9Le;;AAgMhB;AACD;AACA;AACC2D,EAAAA,wBAAwB,EAAE,YAAY;AACrC,UAAM7D,IAAI,CAACC,IAAL,CAAWX,mBAAX,EAAgC;AACrCY,MAAAA,SAAS,EAAE;AAD0B,KAAhC,CAAN;AAGA,GAvMe;;AAyMhB;AACD;AACA;AACC4D,EAAAA,iBAAiB,EAAE,YAAY;AAC9B,UAAMhE,QAAQ,CAACiE,eAAT,EAAN;AACA,UAAMjE,QAAQ,CAACkE,aAAT,EAAN;AACA,UAAMlE,QAAQ,CAACmE,YAAT,EAAN;AACA,GAhNe;;AAkNhB;AACD;AACA;AACCF,EAAAA,eAAe,EAAE,YAAY;AAC5B,UAAMjE,QAAQ,CAAC+D,wBAAT,EAAN;;AACA,QAAK,UAAS,MAAM7D,IAAI,CAACkE,CAAL,CAAQ,uEAAR,CAAf,CAAL,EAAwG;AACvG,YAAM1D,OAAO,CAACC,GAAR,CAAY,CACjBN,MAAM,CAAEH,IAAF,CAAN,CAAe4C,OAAf,CAAwB,sBAAxB,CADiB,EAGjB;AACA5C,MAAAA,IAAI,CAACW,iBAAL,CAAwB;AAAET,QAAAA,SAAS,EAAE,cAAb;AAA6BiE,QAAAA,OAAO,EAAE;AAAtC,OAAxB,CAJiB,CAAZ,CAAN;AAMA;AACD,GA/Ne;;AAiOhB;AACD;AACA;AACCH,EAAAA,aAAa,EAAE,YAAY;AAC1B,UAAMlE,QAAQ,CAAC+D,wBAAT,EAAN;;AACA,QAAK,UAAS,MAAM7D,IAAI,CAACkE,CAAL,CAAQ,iFAAR,CAAf,CAAL,EAAkH;AACjH,YAAMhG,WAAW,CAAE,qBAAF,CAAjB;AACA,YAAMsC,OAAO,CAACC,GAAR,CAAY,CACjBN,MAAM,CAAEH,IAAF,CAAN,CAAe4C,OAAf,CAAwB,kBAAxB,CADiB,EAEjB5C,IAAI,CAACW,iBAAL,CAAwB;AAAET,QAAAA,SAAS,EAAE;AAAb,OAAxB,CAFiB,CAAZ,CAAN;AAIA;AACD,GA7Oe;;AA+OhB;AACD;AACA;AACC+D,EAAAA,YAAY,EAAE,YAAY;AACzB,UAAMnE,QAAQ,CAAC+D,wBAAT,EAAN;;AACA,QAAK,UAAS,MAAM7D,IAAI,CAACkE,CAAL,CAAQ,+EAAR,CAAf,CAAL,EAA+G;AAC9G,YAAMhG,WAAW,CAAE,oBAAF,CAAjB;AACA,YAAMsC,OAAO,CAACC,GAAR,CAAY,CACjBN,MAAM,CAAEH,IAAF,CAAN,CAAe4C,OAAf,CAAwB,iBAAxB,CADiB,EAEjB5C,IAAI,CAACW,iBAAL,CAAwB;AAAET,QAAAA,SAAS,EAAE;AAAb,OAAxB,CAFiB,CAAZ,CAAN;AAIA;AACD,GA3Pe;;AA6PhB;AACD;AACA;AACA;AACA;AACGkE,EAAAA,uBAAuB,EAAE,OAAQC,cAAR,EAAwBC,UAAxB,KAAwC;AAChE,UAAMxE,QAAQ,CAAC8B,WAAT,EAAN,CADgE,CAGhE;;AACA,QAAI2C,UAAU,GAAG/E,OAAO,CAAE8E,UAAF,CAAxB;;AACA,QAAK,OAAMtE,IAAI,CAACkE,CAAL,CAAS,gBAAeK,UAAW,EAAnC,CAAN,MAAiD,IAAtD,EAA6D;AAC5D,YAAMzE,QAAQ,CAAC0E,gBAAT,CAA2BF,UAA3B,EAAuC,IAAvC,CAAN;AACA,KAP+D,CAShE;;;AACA,UAAMtE,IAAI,CAACC,IAAL,CAAWZ,uBAAX,EAAoC;AACzCa,MAAAA,SAAS,EAAE;AAD8B,KAApC,CAAN,CAVgE,CAchE;;AACA,UAAMF,IAAI,CAACU,KAAL,CAAY,sBAAZ,CAAN;AAEA,UAAMP,MAAM,CAAEH,IAAF,CAAN,CAAe8C,cAAf,CACL,gBADK,EAEL;AACCC,MAAAA,IAAI,EAAE;AADP,KAFK,CAAN;AAOA,UAAM0B,QAAQ,GAAG,MAAMzE,IAAI,CAACkE,CAAL,CAAQ,kBAAR,CAAvB;AAEA,UAAMO,QAAQ,CAACC,UAAT,CAAqBL,cAArB,CAAN,CA1BgE,CA4BhE;;AACA,UAAMrE,IAAI,CAAC2E,QAAL,CAAc,MAAM;AACzBC,MAAAA,QAAQ,CAACC,cAAT,CAAyB,uBAAzB,EAAmDC,QAAnD,GAA8D,KAA9D;AACF,KAFO,CAAN,CA7BgE,CAiChE;;AACA,UAAM9E,IAAI,CAACU,KAAL,CAAY,wBAAZ,CAAN;AAEA,UAAMV,IAAI,CAACW,iBAAL,CAAwB;AAAET,MAAAA,SAAS,EAAE;AAAb,KAAxB,CAAN,CApCgE,CAsChE;;AACA,UAAMF,IAAI,CAACU,KAAL,CAAY,iBAAZ,CAAN;AAEA,UAAMV,IAAI,CAACW,iBAAL,CAAwB;AAAET,MAAAA,SAAS,EAAE;AAAb,KAAxB,CAAN;AACA,GA5Sa;;AA8Sd;AACH;AACA;AACA;AACA;AACG6E,EAAAA,cAAc,EAAE,MAAQT,UAAR,IAAwB;AACvC,QAAIC,UAAU,GAAG/E,OAAO,CAAE8E,UAAF,CAAxB;AAEA,UAAMnE,MAAM,CAAEH,IAAF,CAAN,CAAe4C,OAAf,CAAyB,cAAa2B,UAAW,EAAjD,CAAN;AAEA,UAAMvE,IAAI,CAACW,iBAAL,CAAwB;AAAET,MAAAA,SAAS,EAAE;AAAb,KAAxB,CAAN;AACA,GAzTa;;AA2Td;AACH;AACA;AACA;AACA;AACA;AACGsE,EAAAA,gBAAgB,EAAE,gBAAQF,UAAR,EAA8C;AAAA,QAA1BU,YAA0B,uEAAX,KAAW;AAC/D,QAAIT,UAAU,GAAG/E,OAAO,CAAE8E,UAAF,CAAxB;AAEA,UAAMnE,MAAM,CAAEH,IAAF,CAAN,CAAe4C,OAAf,CAAyB,gBAAe2B,UAAW,EAAnD,CAAN;AAEA,UAAMvE,IAAI,CAACW,iBAAL,CAAwB;AAAET,MAAAA,SAAS,EAAE;AAAb,KAAxB,CAAN;;AAEA,QAAK8E,YAAL,EAAoB;AACnB,YAAMlF,QAAQ,CAACkF,YAAT,CAAuBV,UAAvB,CAAN;AACA;AACD,GA3Ua;;AA6Ud;AACH;AACA;AACA;AACA;AACGU,EAAAA,YAAY,EAAE,MAAQV,UAAR,IAAwB;AACrC,QAAIC,UAAU,GAAG/E,OAAO,CAAE8E,UAAF,CAAxB;AAEA,UAAMnE,MAAM,CAAEH,IAAF,CAAN,CAAe4C,OAAf,CAAyB,YAAW2B,UAAW,EAA/C,CAAN,CAHqC,CAKrC;;AACA,UAAMvE,IAAI,CAACiF,eAAL,CAAsBC,QAAQ,IAAIA,QAAQ,CAACxC,MAAT,OAAsB,GAAxD,CAAN;AACA,GAzVa;;AA2VhB;AACD;AACA;AACGyC,EAAAA,iBAAiB,EAAE,YAAY;AAC9B,QAAK,OAAMnF,IAAI,CAACkE,CAAL,CAAQ,yCAAR,CAAN,MAA8D,IAAnE,EAA0E;AACzE,YAAM/D,MAAM,CAAEH,IAAF,CAAN,CAAe8C,cAAf,CAA+B,iBAA/B,EAAkD;AAAEC,QAAAA,IAAI,EAAE;AAAR,OAAlD,CAAN;AACA,YAAM5C,MAAM,CAAEH,IAAF,CAAN,CAAe4C,OAAf,CAAwB,iBAAxB,CAAN;AACA,YAAM5C,IAAI,CAACW,iBAAL,CAAwB;AAAET,QAAAA,SAAS,EAAE;AAAb,OAAxB,CAAN;AACA,YAAMJ,QAAQ,CAACsF,2BAAT,EAAN;AACF;AACC,GArWa;;AAuWhB;AACD;AACA;AACGA,EAAAA,2BAA2B,EAAE,YAAY;AACxC,UAAMpF,IAAI,CAACqF,MAAL,CAAa;AAAEnF,MAAAA,SAAS,EAAE,CAAE,cAAF,EAAkB,kBAAlB;AAAb,KAAb,CAAN;AAEF,UAAMoF,oBAAoB,GAAG,gCAA7B;;AAEA,QAAK,OAAMtF,IAAI,CAACkE,CAAL,CAAQoB,oBAAR,CAAN,MAAyC,IAA9C,EAAqD;AACpD,YAAMnF,MAAM,CAAEH,IAAF,CAAN,CAAe8C,cAAf,CAA+BwC,oBAA/B,EAAqD;AAAEvC,QAAAA,IAAI,EAAE;AAAR,OAArD,CAAN;AACA,YAAM5C,MAAM,CAAEH,IAAF,CAAN,CAAe4C,OAAf,CAAwB0C,oBAAxB,CAAN;AACA,KAHD,MAGO;AACN,YAAMxF,QAAQ,CAACsF,2BAAT,EAAN;AACA;AACC,GArXa;;AAuXhB;AACD;AACA;AACCxE,EAAAA,uBAAuB,EAAE,YAAY;AACpC,QAAI2E,UAAU,GAAG,KAAjB;AACA,UAAMC,UAAU,GAAG,MAAMxF,IAAI,CAACkE,CAAL,CAAQ,0CAAR,CAAzB;;AACA,QAAKsB,UAAL,EAAkB;AACjB,YAAMA,UAAU,CAAC9E,KAAX,EAAN;AACA6E,MAAAA,UAAU,GAAG,IAAb;AACA,KANmC,CAQpC;;;AACA,UAAME,mBAAmB,GAAG,MAAMzF,IAAI,CAACkE,CAAL,CAAQ,8CAAR,CAAlC;;AACA,QAAKuB,mBAAL,EAA2B;AAC1B,YAAMA,mBAAmB,CAAC/E,KAApB,EAAN;AACA6E,MAAAA,UAAU,GAAG,IAAb;AACA;;AAED,QAAKA,UAAL,EAAkB;AACjB,YAAMvF,IAAI,CAACW,iBAAL,CAAwB;AAAET,QAAAA,SAAS,EAAE;AAAb,OAAxB,CAAN;AACA;AACD,GA5Ye;;AA8YhB;AACD;AACA;AACA;AACCwF,EAAAA,iBAAiB,EAAE,kBAA6B;AAAA,QAArBC,QAAqB,uEAAV,IAAU;AAC/C,UAAMC,cAAc,GAAG,MAAM5F,IAAI,CAACkE,CAAL,CAAQ,0BAAR,CAA7B;;AACA,QAAO,CAAE0B,cAAJ,IAAwBD,QAA7B,EAAwC;AACvC,YAAMC,cAAc,CAAClF,KAAf,EAAN;AACA;AAED;AAxZe,CAAjB;AA2ZAmF,MAAM,CAACC,OAAP,GAAiBhG,QAAjB","sourcesContent":["/**\n * External dependencies\n */\nconst config = require( 'config' );\n\n/**\n * Internal dependencies\n */\nconst { clearAndFillInput, setCheckbox } = require( '../page-utils' );\nconst {\n\tWP_ADMIN_ALL_ORDERS_VIEW,\n\tWP_ADMIN_ALL_PRODUCTS_VIEW,\n\tWP_ADMIN_DASHBOARD,\n\tWP_ADMIN_LOGIN,\n\tWP_ADMIN_NEW_COUPON,\n\tWP_ADMIN_NEW_ORDER,\n\tWP_ADMIN_NEW_PRODUCT,\n\tWP_ADMIN_PERMALINK_SETTINGS,\n\tWP_ADMIN_PLUGINS,\n\tWP_ADMIN_SETUP_WIZARD,\n\tWP_ADMIN_WC_HOME,\n\tWP_ADMIN_WC_SETTINGS,\n\tWP_ADMIN_WC_EXTENSIONS,\n\tWP_ADMIN_WC_HELPER,\n\tWP_ADMIN_NEW_SHIPPING_ZONE,\n\tWP_ADMIN_ANALYTICS_PAGES,\n\tWP_ADMIN_ALL_USERS_VIEW,\n\tWP_ADMIN_IMPORT_PRODUCTS,\n\tWP_ADMIN_PLUGIN_INSTALL,\n\tWP_ADMIN_WP_UPDATES,\n\tIS_RETEST_MODE,\n} = require( './constants' );\n\nconst { getSlug, waitForTimeout } = require('./utils');\n\nconst baseUrl = config.get( 'url' );\nconst WP_ADMIN_SINGLE_CPT_VIEW = ( postId ) => baseUrl + `wp-admin/post.php?post=${ postId }&action=edit`;\n\nconst merchant = {\n\tlogin: async () => {\n\t\tawait page.goto( WP_ADMIN_LOGIN, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\n\t\tawait expect( page.title() ).resolves.toMatch( 'Log In' );\n\n\t\tawait clearAndFillInput( '#user_login', ' ' );\n\n\t\tawait page.type( '#user_login', config.get( 'users.admin.username' ) );\n\t\tawait page.type( '#user_pass', config.get( 'users.admin.password' ) );\n\n\t\tawait Promise.all( [\n\t\t\tpage.click( 'input[type=submit]' ),\n\t\t\tpage.waitForNavigation( { waitUntil: 'networkidle0' } ),\n\t\t\tmerchant.dismissOnboardingWizard(),\n\t\t] );\n\t},\n\n\tlogout: async () => {\n\t\t// Log out link in admin bar is not visible so can't be clicked directly.\n\t\tconst logoutLinks = await page.$$eval(\n\t\t\t'#wp-admin-bar-logout a',\n\t\t\t( am ) => am.filter( ( e ) => e.href ).map( ( e ) => e.href )\n\t\t);\n\n\t\tif ( logoutLinks && logoutLinks[0] ) {\n\t\t\tawait page.goto(logoutLinks[0], {\n\t\t\t\twaitUntil: 'networkidle0',\n\t\t\t});\n\t\t}\n\t},\n\n\topenAllOrdersView: async () => {\n\t\tawait page.goto( WP_ADMIN_ALL_ORDERS_VIEW, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenAllProductsView: async () => {\n\t\tawait page.goto( WP_ADMIN_ALL_PRODUCTS_VIEW, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenDashboard: async () => {\n\t\tawait page.goto( WP_ADMIN_DASHBOARD, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenNewCoupon: async () => {\n\t\tawait page.goto( WP_ADMIN_NEW_COUPON, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenNewOrder: async () => {\n\t\tawait page.goto( WP_ADMIN_NEW_ORDER, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenNewProduct: async () => {\n\t\tawait page.goto( WP_ADMIN_NEW_PRODUCT, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenPermalinkSettings: async () => {\n\t\tawait page.goto( WP_ADMIN_PERMALINK_SETTINGS, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenPlugins: async () => {\n\t\tawait page.goto( WP_ADMIN_PLUGINS, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenSettings: async ( tab, section = null ) => {\n\t\tlet settingsUrl = WP_ADMIN_WC_SETTINGS + tab;\n\n\t\tif ( section ) {\n\t\t\tsettingsUrl += `&section=${ section }`;\n\t\t}\n\n\t\tawait page.goto( settingsUrl, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenExtensions: async () => {\n\t\tawait page.goto( WP_ADMIN_WC_EXTENSIONS, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenHelper: async () => {\n\t\tawait page.goto( WP_ADMIN_WC_HELPER, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\trunSetupWizard: async () => {\n\t\t\tconst setupWizard = IS_RETEST_MODE ? WP_ADMIN_SETUP_WIZARD : WP_ADMIN_WC_HOME;\n\t\t\tawait page.goto( setupWizard, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\n\tgoToOrder: async ( orderId ) => {\n\t\tawait page.goto( WP_ADMIN_SINGLE_CPT_VIEW( orderId ), {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\tgoToProduct: async ( productId ) => {\n\t\tawait page.goto( WP_ADMIN_SINGLE_CPT_VIEW( productId ), {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\tupdateOrderStatus: async ( orderId, status ) => {\n\t\tawait page.goto( WP_ADMIN_SINGLE_CPT_VIEW( orderId ), {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t\tawait expect( page ).toSelect( '#order_status', status );\n\t\tawait waitForTimeout( 2000 );\n\t\tawait expect( page ).toClick( 'button.save_order' );\n\t\tawait page.waitForSelector( '#message' );\n\t\tawait expect( page ).toMatchElement( '#message', { text: 'Order updated.' } );\n\t},\n\n\tverifyOrder: async (orderId, productName, productPrice, quantity, orderTotal, ensureCustomerRegistered = false) => {\n\t\tawait merchant.goToOrder(orderId);\n\n\t\t// Verify that the order page is indeed of the order that was placed\n\t\t// Verify order number\n\t\tawait expect(page).toMatchElement('.woocommerce-order-data__heading', {text: 'Order #' + orderId + ' details'});\n\n\t\t// Verify product name\n\t\tawait expect(page).toMatchElement('.wc-order-item-name', {text: productName});\n\n\t\t// Verify product cost\n\t\tawait expect(page).toMatchElement('.woocommerce-Price-amount.amount', {text: productPrice});\n\n\t\t// Verify product quantity\n\t\tawait expect(page).toMatchElement('.quantity', {text: quantity.toString()});\n\n\t\t// Verify total order amount without shipping\n\t\tawait expect(page).toMatchElement('.line_cost', {text: orderTotal});\n\n\t\tif ( ensureCustomerRegistered ) {\n\t\t\t// Verify customer profile link is present to verify order was placed by a registered customer, not a guest\n\t\t\tawait expect( page ).toMatchElement( 'label[for=\"customer_user\"] a[href*=user-edit]', { text: 'Profile' } );\n\t\t}\n\t},\n\n\topenNewShipping: async () => {\n\t\tawait page.goto( WP_ADMIN_NEW_SHIPPING_ZONE, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenEmailLog: async () => {\n\t\tawait page.goto( `${baseUrl}wp-admin/tools.php?page=wpml_plugin_log`, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenAnalyticsPage: async ( pageName ) => {\n\t\tawait page.goto( WP_ADMIN_ANALYTICS_PAGES + pageName, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\topenAllUsersView: async () => {\n\t\tawait page.goto( WP_ADMIN_ALL_USERS_VIEW, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n  \topenImportProducts: async () => {\n\t\tawait page.goto( WP_ADMIN_IMPORT_PRODUCTS , {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\t/**\n\t * Opens the WordPress updates page at Dashboard > Updates.\n\t */\n\topenWordPressUpdatesPage: async () => {\n\t\tawait page.goto( WP_ADMIN_WP_UPDATES, {\n\t\t\twaitUntil: 'networkidle0',\n\t\t} );\n\t},\n\n\t/**\n\t * Installs all pending updates on the Dashboard > Updates page, including WordPress, plugins, and themes.\n\t */\n\tinstallAllUpdates: async () => {\n\t\tawait merchant.updateWordPress();\n\t\tawait merchant.updatePlugins();\n\t\tawait merchant.updateThemes();\n\t},\n\n\t/**\n\t * Updates WordPress if there are any updates available.\n\t */\n\tupdateWordPress: async () => {\n\t\tawait merchant.openWordPressUpdatesPage();\n\t\tif ( null !== await page.$( 'form[action=\"update-core.php?action=do-core-upgrade\"][name=\"upgrade\"]' ) ) {\n\t\t\tawait Promise.all([\n\t\t\t\texpect( page ).toClick( 'input.button-primary' ),\n\n\t\t\t\t// The WordPress update can take some time, so setting a longer timeout here\n\t\t\t\tpage.waitForNavigation( { waitUntil: 'networkidle0', timeout: 1000000 } ),\n\t\t\t]);\n\t\t}\n\t},\n\n\t/**\n\t * Updates all installed plugins if there are updates available.\n\t */\n\tupdatePlugins: async () => {\n\t\tawait merchant.openWordPressUpdatesPage();\n\t\tif ( null !== await page.$( 'form[action=\"update-core.php?action=do-plugin-upgrade\"][name=\"upgrade-plugins\"]' ) ) {\n\t\t\tawait setCheckbox( '#plugins-select-all' );\n\t\t\tawait Promise.all([\n\t\t\t\texpect( page ).toClick( '#upgrade-plugins' ),\n\t\t\t\tpage.waitForNavigation( { waitUntil: 'networkidle0' } ),\n\t\t\t]);\n\t\t}\n\t},\n\n\t/**\n\t * Updates all installed themes if there are updates available.\n\t */\n\tupdateThemes: async () => {\n\t\tawait merchant.openWordPressUpdatesPage();\n\t\tif ( null !== await page.$( 'form[action=\"update-core.php?action=do-theme-upgrade\"][name=\"upgrade-themes\"]' )) {\n\t\t\tawait setCheckbox( '#themes-select-all' );\n\t\t\tawait Promise.all([\n\t\t\t\texpect( page ).toClick( '#upgrade-themes' ),\n\t\t\t\tpage.waitForNavigation( { waitUntil: 'networkidle0' } ),\n\t\t\t]);\n\t\t}\n\t},\n\n\t/* Uploads and activates a plugin located at the provided file path. This will also deactivate and delete the plugin if it exists.\n\t*\n\t* @param {string} pluginFilePath The location of the plugin zip file to upload.\n\t* @param {string} pluginName The name of the plugin. For example, `WooCommerce`.\n\t*/\n   uploadAndActivatePlugin: async ( pluginFilePath, pluginName ) => {\n\t   await merchant.openPlugins();\n\n\t   // Deactivate and delete the plugin if it exists\n\t   let pluginSlug = getSlug( pluginName );\n\t   if ( await page.$( `a#deactivate-${pluginSlug}` ) !== null ) {\n\t\t   await merchant.deactivatePlugin( pluginName, true );\n\t   }\n\n\t   // Open the plugin install page\n\t   await page.goto( WP_ADMIN_PLUGIN_INSTALL, {\n\t\t   waitUntil: 'networkidle0',\n\t   } );\n\n\t   // Upload the plugin zip\n\t   await page.click( 'a.upload-view-toggle' );\n\n\t   await expect( page ).toMatchElement(\n\t\t   'p.install-help',\n\t\t   {\n\t\t\t   text: 'If you have a plugin in a .zip format, you may install or update it by uploading it here.'\n\t\t   }\n\t   );\n\n\t   const uploader = await page.$( 'input[type=file]' );\n\n\t   await uploader.uploadFile( pluginFilePath );\n\n\t   // Manually update the button to `enabled` so we can submit the file\n\t   await page.evaluate(() => {\n\t\t   document.getElementById( 'install-plugin-submit' ).disabled = false;\n\t\t});\n\n\t   // Click to upload the file\n\t   await page.click( '#install-plugin-submit' );\n\n\t   await page.waitForNavigation( { waitUntil: 'networkidle0' } );\n\n\t   // Click to activate the plugin\n\t   await page.click( '.button-primary' );\n\n\t   await page.waitForNavigation( { waitUntil: 'networkidle0' } );\n   },\n\n   /**\n\t* Activate a given plugin by the plugin's name.\n\t*\n\t* @param {string} pluginName The name of the plugin to activate. For example, `WooCommerce`.\n\t*/\n   activatePlugin: async ( pluginName ) => {\n\t   let pluginSlug = getSlug( pluginName );\n\n\t   await expect( page ).toClick( `a#activate-${pluginSlug}` );\n\n\t   await page.waitForNavigation( { waitUntil: 'networkidle0' } );\n   },\n\n   /**\n\t* Deactivate a plugin by the plugin's name with the option to delete the plugin as well.\n\t*\n\t* @param {string} pluginName The name of the plugin to deactivate. For example, `WooCommerce`.\n\t* @param {Boolean} deletePlugin Pass in `true` to delete the plugin. Defaults to `false`.\n\t*/\n   deactivatePlugin: async ( pluginName, deletePlugin = false ) => {\n\t   let pluginSlug = getSlug( pluginName );\n\n\t   await expect( page ).toClick( `a#deactivate-${pluginSlug}` );\n\n\t   await page.waitForNavigation( { waitUntil: 'networkidle0' } );\n\n\t   if ( deletePlugin ) {\n\t\t   await merchant.deletePlugin( pluginName );\n\t   }\n   },\n\n   /**\n\t* Delete a plugin by the plugin's name.\n\t*\n\t* @param {string} pluginName The name of the plugin to delete. For example, `WooCommerce`.\n\t*/\n   deletePlugin: async ( pluginName ) => {\n\t   let pluginSlug = getSlug( pluginName );\n\n\t   await expect( page ).toClick( `a#delete-${pluginSlug}` );\n\n\t   // Wait for Ajax calls to finish\n\t   await page.waitForResponse( response => response.status() === 200 );\n   },\n\n\t/**\n\t * Runs the database update if needed. For example, after uploading the WooCommerce plugin or updating WooCommerce.\n\t */\n   runDatabaseUpdate: async () => {\n\t   if ( await page.$( '.updated.woocommerce-message.wc-connect' ) !== null ) {\n\t\t   await expect( page ).toMatchElement( 'a.wc-update-now', { text: 'Update WooCommerce Database' } );\n\t\t   await expect( page ).toClick( 'a.wc-update-now' );\n\t\t   await page.waitForNavigation( { waitUntil: 'networkidle0' } );\n\t\t   await merchant.checkDatabaseUpdateComplete();\n\t\t}\n   },\n\n\t/**\n\t * Checks if the database update is complete, if not, refresh the page until it is.\n\t */\n   checkDatabaseUpdateComplete: async () => {\n\t   await page.reload( { waitUntil: [ 'networkidle0', 'domcontentloaded'] } );\n\n\t\tconst thanksButtonSelector = 'a.components-button.is-primary';\n\n\t\tif ( await page.$( thanksButtonSelector ) !== null ) {\n\t\t\tawait expect( page ).toMatchElement( thanksButtonSelector, { text: 'Thanks!' } );\n\t\t\tawait expect( page ).toClick( thanksButtonSelector );\n\t\t} else {\n\t\t\tawait merchant.checkDatabaseUpdateComplete();\n\t\t}\n   },\n\n\t/**\n\t * Dismiss the onboarding wizard if it is open.\n\t */\n\tdismissOnboardingWizard: async () => {\n\t\tlet waitForNav = false;\n\t\tconst skipButton = await page.$( '.woocommerce-profile-wizard__footer-link' );\n\t\tif ( skipButton ) {\n\t\t\tawait skipButton.click();\n\t\t\twaitForNav = true;\n\t\t}\n\n\t\t// Dismiss usage tracking pop-up window if it appears on a new site\n\t\tconst usageTrackingHeader = await page.$( '.woocommerce-usage-modal button.is-secondary' );\n\t\tif ( usageTrackingHeader ) {\n\t\t\tawait usageTrackingHeader.click();\n\t\t\twaitForNav = true;\n\t\t}\n\n\t\tif ( waitForNav ) {\n\t\t\tawait page.waitForNavigation( { waitUntil: 'networkidle0' } );\n\t\t}\n\t},\n\n\t/**\n\t * Expand or collapse the WP admin menu.\n\t * @param {boolean} collapse Flag to collapse or expand the menu. Default collapse.\n\t */\n\tcollapseAdminMenu: async ( collapse = true ) => {\n\t\tconst collapseButton = await page.$( '.folded #collapse-button' );\n\t\tif ( ( ! collapseButton ) == collapse ) {\n\t\t\tawait collapseButton.click();\n\t\t}\n\n\t},\n};\n\nmodule.exports = merchant;\n"]}